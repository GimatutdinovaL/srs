{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/GimatutdinovaL/srs/refs/heads/main/%D0%BA%D0%B0%D1%80%D1%82%D1%8B.json",
  "title": "OpenAPI-спецификация Сервиса управления банковскими картами",
  "description": "Методы для управления банковскими картами Все схемы запросов и ответов соответствуют JSON Schema не ниже Draft 4",
  "type": "object",
  "properties": {
    "Link": {
      "type": "object",
      "properties": {
        "href": {
          "type": "string",
          "description": "URL ссылки"
        },
        "method": {
          "type": "string",
          "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"],
          "description": "HTTP метод",
          "example": "GET"
        }
      }
    },
    "CardProduct": {
      "type": "object",
      "description": "Вид банковской карты",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
          "description": "Уникальный идентификатор вида карты",
          "example": "123e4567-e89b-12d3-a456-426614174000"
        },
        "productType": {
          "type": "string",
          "enum": ["debit1", "debit2"],
          "description": "Тип карты с тарифом",
          "x-enum-descriptions": {
            "debit1": "Дебетовая карта классическая с готовым обслуживанием 0 руб., кешбек на асе покупки 1%",
            "debit2": "Дебетовая карта премиальная с годовым обслуживанием 499 руб., кешбек на все аркупки 3%"
          },
          "example": "debit1"
        }
      }
    },
    "CardProductsRS": {
      "type": "object",
      "description": "Список карт",
      "properties": {
        "products": {
          "type": "array",
          "items": {
            "$ref": "#/properties/CardProduct"
          }
        },
        "_links": {
          "type": "object",
          "properties": {
            "self": {
              "$ref": "#/properties/Link"
            },
            "create_card": {
              "$ref": "#/properties/Link",
              "description": "Cсылка на создание зявки на новую карту"
            }
          },
          "example": {
            "self": {
              "href": "/api/v1/card-products",
              "method": "GET"
            },
            "create_card": {
              "href": "/api/v1/cards",
              "method": "POST"
            }
          }
        }
      }
    },
    "CardRQ": {
      "type": "object",
      "description": "Запрос на создание заявки на новую карту",
      "required": ["productType"],
      "properties": {
        "productType": {
          "type": "string",
          "enum": ["debit1", "debit2"],
          "description": "Тип карты с тарифом",
          "example": "debit1"
        }
      }
    },
    "CardRS": {
      "type": "object",
      "description": "Ответ на создание заявки на новую карту",
      "additionalProperties": false,
      "required": ["id", "date", "cardStatus", "productType"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Уникальный идентификатор заявки на карту",
          "example": "550e8400-e29b-41d4-a716-446655440000"
        },
        "date": {
          "type": "string",
          "format": "date-time",
          "description": "Дата и время создания",
          "example": "2026-01-01T10:30:00Z"
        },
        "cardStatus": {
          "type": "string",
          "enum": ["NEW", "IN_PROGRESS", "COMPLETED", "CANCELLED"],
          "description": "Статус заказа",
          "example": "NEW"
        },
        "productType": {
          "type": "string",
          "enum": ["debit1", "debit2"],
          "description": "Тип карты с тарифом",
          "example": "debit1"
        },
        "_links": {
          "type": "object",
          "properties": {
            "self": {
              "$ref": "#/properties/Link"
            },
            "cancel": {
              "$ref": "#/properties/Link",
              "description": "Ссылка для отмены заявки"
            },
            "delivery_address": {
              "$ref": "#/properties/Link",
              "description": "Ссылка для указания адреса доставки"
            }
          },
          "example": {
            "self": {
              "href": "/api/v1/cards/550e8400-e29b-41d4-a716-446655440000",
              "method": "GET"
            },
            "cancel": {
              "href": "/api/v1/cards/550e8400-e29b-41d4-a716-446655440000",
              "method": "DELETE"
            },
            "delivery_address": {
              "href": "/api/v1/delivery-address",
              "method": "POST"
            }
          }
        }
      }
    },
    "DeliveryAddressCardRQ": {
      "type": "object",
      "description": "Запрос на создание адреса доставки",
      "required": ["cardId", "country", "city", "street", "houseNumber", "apartment"],
      "properties": {
        "cardId": {
          "type": "string",
          "format": "uuid",
          "description": "ID заявки на карту",
          "example": "550e8400-e29b-41d4-a716-446655440000"
        },
        "country": {
          "type": "string",
          "maxLength": 50,
          "description": "Страна",
          "example": "Россия"
        },
        "city": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Город",
          "example": "Казань"
        },
        "street": {
          "type": "string",
          "minLength": 2,
          "maxLength": 200,
          "description": "Улица",
          "example": "Баумана"
        },
        "houseNumber": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Номер дома",
          "example": "10"
        },
        "apartment": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Квартира/офис",
          "example": "25"
        },
        "comment": {
          "type": "string",
          "minLength": 2,
          "maxLength": 200,
          "description": "Комментарий для курьера (опционально)",
          "example": "Код домофона 25К"
        }
      }
    },
    "DeliveryAddressCardRS": {
      "type": "object",
      "description": "Ответ на создание адреса доставки",
      "additionalProperties": false,
      "required": ["id", "cardId", "createdAt"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Уникальный идентификатор адреса",
          "example": "660e8400-e29b-41d4-a716-446655440000"
        },
        "cardId": {
          "type": "string",
          "format": "uuid",
          "description": "ID заявки на карту",
          "example": "550e8400-e29b-41d4-a716-446655440000"
        },
        "country": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Страна",
          "example": "Россия"
        },
        "city": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Город",
          "example": "Казань"
        },
        "street": {
          "type": "string",
          "minLength": 2,
          "maxLength": 200,
          "description": "Улица",
          "example": "Баумана"
        },
        "houseNumber": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Номер дома",
          "example": "10"
        },
        "apartment": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Квартира/офис",
          "example": "25"
        },
        "comment": {
          "type": "string",
          "minLength": 0,
          "maxLength": 200,
          "description": "Комментарий для курьера",
          "example": "Код домофона 25К"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Дата и время создания адреса",
          "example": "2026-01-01T10:35:00Z"
        },
        "_links": {
          "type": "object",
          "properties": {
            "self": {
              "$ref": "#/properties/Link"
            },
            "update": {
              "$ref": "#/properties/Link",
              "description": "Ссылка для обновления адреса доставки"
            }
          },
          "example": {
            "self": {
              "href": "/api/v1/delivery-address/660e8400-e29b-41d4-a716-446655440000",
              "method": "GET"
            },
            "update": {
              "href": "/api/v1/delivery-address",
              "method": "PATCH"
            }
          }
        }
      }
    },
    "DeliveryAddressUpdateRQ": {
      "type": "object",
      "description": "Запрос на обновление адреса доставки",
      "properties": {
        "country": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Страна",
          "example": "Россия"
        },
        "city": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Город",
          "example": "Казань"
        },
        "street": {
          "type": "string",
          "minLength": 2,
          "maxLength": 200,
          "description": "Улица",
          "example": "Баумана"
        },
        "houseNumber": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Номер дома",
          "example": "10"
        },
        "apartment": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Квартира/офис",
          "example": "69"
        },
        "comment": {
          "type": "string",
          "minLength": 0,
          "maxLength": 200,
          "description": "Комментарий для курьера",
          "example": "Код домофона 25К, этаж 5"
        }
      }
    },
    "DeliveryAddressUpdateRS": {
      "type": "object",
      "description": "Ответ на обновление адреса доставки",
      "additionalProperties": false,
      "required": ["id", "cardId", "updatedAt"],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Уникальный идентификатор адреса",
          "example": "660e8400-e29b-41d4-a716-446655440000"
        },
        "cardId": {
          "type": "string",
          "format": "uuid",
          "description": "ID заявки на карту",
          "example": "550e8400-e29b-41d4-a716-446655440000"
        },
        "country": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Страна",
          "example": "Россия"
        },
        "city": {
          "type": "string",
          "minLength": 2,
          "maxLength": 50,
          "description": "Город",
          "example": "Казань"
        },
        "street": {
          "type": "string",
          "minLength": 2,
          "maxLength": 200,
          "description": "Улица",
          "example": "Баумана"
        },
        "houseNumber": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Номер дома",
          "example": "10"
        },
        "apartment": {
          "type": "string",
          "minLength": 2,
          "maxLength": 10,
          "description": "Квартира/офис",
          "example": "69"
        },
        "comment": {
          "type": "string",
          "minLength": 0,
          "maxLength": 200,
          "description": "Комментарий для курьера",
          "example": "Код домофона 25К, этаж 5"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Дата и время обновления адреса",
          "example": "2026-01-01T10:40:00Z"
        },
        "_links": {
          "type": "object",
          "properties": {
            "self": {
              "$ref": "#/properties/Link",
              "description": "Ссылка для получения информации об обновленном адресе"
            }
          },
          "example": {
            "self": {
              "href": "/api/v1/delivery-address/660e8400-e29b-41d4-a716-446655440000",
              "method": "GET"
            }
          }
        }
      }
    },
    "TwoFactorAuthRQ": {
      "type": "object",
      "description": "Запрос на двухфакторную аутентификацию",
      "required": ["code", "sessionId"],
      "properties": {
        "code": {
          "type": "string",
          "description": "Код подтверждения из SMS",
          "example": "123456"
        },
        "sessionId": {
          "type": "string",
          "format": "uuid",
          "description": "Идентификатор сессии",
          "example": "770e8400-e29b-41d4-a716-446655440000"
        }
      }
    },
    "TwoFactorAuthRS": {
      "type": "object",
      "description": "Ответ на двухфакторную аутентификацию",
      "required": ["accessToken", "refreshToken", "expiresIn"],
      "properties": {
        "accessToken": {
          "type": "string",
          "description": "JWT токен доступа",
          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ"
        },
        "refreshToken": {
          "type": "string",
          "description": "Токен для обновления доступа",
          "example": "refresh_880e8400-e29b-41d4-a716-446655440000"
        },
        "expiresIn": {
          "type": "integer",
          "description": "Время жизни токена в секундах",
          "example": 3600
        },
        "tokenType": {
          "type": "string",
          "description": "Тип токена",
          "example": "Bearer"
        }
      }
    },
    "Error": {
      "type": "object",
      "required": ["error"],
      "properties": {
        "error": {
          "type": "object",
          "required": ["code", "message", "timestamp"],
          "properties": {
            "code": {
              "type": "string",
              "description": "Код ошибки",
              "example": "VALIDATION_ERROR"
            },
            "message": {
              "type": "string",
              "description": "Сообщение об ошибке",
              "example": "One or more fields are invalid"
            },
            "timestamp": {
              "type": "string",
              "format": "date-time",
              "description": "Время возникновения ошибки",
              "example": "2025-01-01T10:30:00Z"
            }
          }
        }
      }
    },
    "ValidationError": {
      "type": "object",
      "properties": {
        "error": {
          "type": "object",
          "properties": {
            "code": {
              "type": "string",
              "example": "VALIDATION_FAILED"
            },
            "message": {
              "type": "string",
              "example": "Validation failed for request body"
            },
            "details": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "field": {
                    "type": "string",
                    "example": "postalCode"
                  },
                  "message": {
                    "type": "string",
                    "example": "must be exactly 6 digits"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}